<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Flock</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet" media="screen">
		
	</head>
	<body>
		<p id="demo"></p>

		<script>
			var x=document.getElementById("demo");
			var foursquareData;

			function getLocation()
			  {
			  if (navigator.geolocation)
			    {
			    navigator.geolocation.getCurrentPosition(showPosition);
			    }
			  else{x.innerHTML="Geolocation is not supported by this browser.";}
			  }
			function showPosition(position)
			  {
			    var xhr = new XMLHttpRequest();
			    xhr.open("GET", "https://api.foursquare.com/v2/venues/search?ll=" + position.coords.latitude + "," + position.coords.longitude + "&oauth_token=2ZBTC4SWH5UO1UTOPCXOARGZ5RXLFM3NFRVE1UNFDMNGLGPN&v=20130928", false);
			    xhr.send();

			    foursquareData = JSON.parse(xhr.responseText);

			  //x.innerHTML= "Status: " + xhr.status + "<br/>" + "StatusText: " + xhr.responseText;

			  	var ul = document.createElement("ul");

			  	for (var i = 0;i<foursquareData.response.venues.length;i++) {
			  		var listItem = document.createElement("li");
			  		listItem.setAttribute("data-id", foursquareData.response.venues[i].id );
			  		listItem.setAttribute("onclick", "locationClicked(this)");
			  		listItem.appendChild(document.createTextNode(foursquareData.response.venues[i].name));
			  		ul.appendChild(listItem); 
			  	}

			  	x.appendChild(ul);

		    }

		    function locationClicked(element) {
		    	console.log("Name: " + element.innerHTML);
		    	console.log("Id: " + element.getAttribute("data-id"));
		    }

		    window.onLoad = getLocation();



		</script>
		<script src="js/jquery-2.0.3.min.js"></script>
		<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
	</body>
</html>
